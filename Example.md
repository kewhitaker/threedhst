# GOODS-ERS G141 Example #

Download the four threedhst-tar.gz files from the Downloads tab.

```
#### Make example directory
cd $THREED_ROOT
mkdir ERS
cd ERS
mv ~/Downloads/threedhst-*.tar.gz . ## assuming they're in ~/Downloads

#### Make directory structure
tar xvfz threedhst-directories.tar.gz
tar xvfz threedhst-IREF.tar.gz
tar xvfz threedhst-CONF.tar.gz

#### Extract the example GOODS-ERS files to ./RAW
tar xvfz threedhst-ERS-G141.tar.gz

export iref="${PWD}/IREF/"  # This could go in `~/.bashrc` to avoid having to type it every time

csh
pyraf --ipython
```

Now, within PYRAF:

```
import threedhst

#### Set SExtractor detection threshold to 10-sigma to make the test catalog small.
#### To see the other options currently defined, use threedhst.showOptions()
threedhst.options['DETECT_THRESH'] = 10
threedhst.options['ANALYSIS_THRESH'] = 10

#### Set the filenames for the ERS G141 observations (in ./RAW)
direct = 'ib6o23020_asn.fits'
grism = 'ib6o23010_asn.fits'

#### Run the pipeline
threedhst.process_grism.reduction_script(asn_grism_file=grism, asn_direct_file=direct)
```

The pipeline is essentially a wrapper around the aXe routines, producing a catalog and a few other potentially useful files in the process (and this can be developed further, e.g. cleaning up the raw catalogs).  The `ERS/DATA` contains the following files:

```
  ib6o23010CONT_asn.fits - an ASN list used to generate the next file
  ib6o23010CONT_drz.fits - a full contamination image of the field, which can be compared to the grism mosaic
  ib6o23010_asn.fits - the input *grism* ASN list
  ib6o23010_drz.fits - the Multidrizzled mosaic of the grism exposures
  ib6o23010_shifts.txt - shifts used by Multidrizzle
  ib6o23010_zeroth.reg - A DS9 region file showing where the 0^th^ order objects should appear
  ib6o23020_asn.fits - the input *direct* ASN list
  ib6o23020_asn.pointing.reg - a DS9 region file with polygons for all of the exposures in the ASN list
  ib6o23020_drz.cat - SExtractor catalog for the next file
  ib6o23020_drz.fits - Multidrizzled mosaic of the direct images
  ib6o23020_drz.reg - DS9 region file for the objects in the catalog
  ib6o23020_seg.fits - SExtractor segmentation map
  ib6o23020_shifts.txt - Shifts used by Multidrizzle, currently found with `tweakshifts`.
  ib6o23020_tweak.fits - Dummy WCS file generated by `tweakshifts`.
```


After the pipeline runs, the output spectra will be stored in `ERS/DRIZZLE_G141`.  All of the 1D extracted spectra are in a single file, `ib6o23020_2_opt.SPC.fits`.  Note that the extensions of this file are not in the same order as the object numbers in the SExtractor catalog; they're sorted like 1, 100, 101, ....  However, the extensions are named with the object number, like `ib6o23020_2_opt.SPC.fits[BEAM_#A]`.

The 2D spectra are in individual files, named `ib6o23020_mef_ID#.fits`, which each have extensions:
```
  1 SCI     
  2 ERR     
  3 EXPT    
  4 CON     
  5 MOD     
  6 VAR     
  7 WHT     
```

The pipeline produces an HTML table with thumbnails of the direct images, 1D, and 2D spectra, which look like
![http://www.astro.yale.edu/brammer/ERS/grism.png](http://www.astro.yale.edu/brammer/ERS/grism.png)

For an example of the full webpage, see http://www.astro.yale.edu/brammer/ERS/HTMLv2/ib6o23020_index.html.